# Project Files Reference

This document provides a brief description of each file in the codebase.

## Root Configuration Files

| File | Description |
|------|-------------|
| `package.json` | NPM dependencies and scripts configuration (includes @types/node for Convex actions) |
| `tsconfig.json` | TypeScript compiler configuration |
| `vite.config.ts` | Vite build tool configuration |
| `convex.json` | Convex backend configuration |
| `netlify.toml` | Netlify deployment and routing configuration |
| `.gitignore` | Git ignore patterns for dependencies and build files |
| `.env.local` | Local environment variables (not tracked in git) |

## Documentation

| File | Description |
|------|-------------|
| `README.md` | Project overview, setup instructions, and quick start guide |
| `SETUP.md` | Detailed step-by-step setup instructions |
| `PROJECT_SUMMARY.md` | Comprehensive project architecture and implementation summary |
| `files.md` | This file - reference for all project files |
| `CHANGELOG.md` | Version history and release notes |

## Convex Backend (`convex/`)

| File | Description |
|------|-------------|
| `schema.ts` | Database schema definitions for threads, messages, and mail_inboxes |
| `agent.ts` | OpenAI integration action for AI agent responses (Node.js) |
| `agentQueries.ts` | Internal queries and mutations for agent message handling |
| `messages.ts` | Public queries and mutations for thread and message management |
| `mail.ts` | AgentMail actions for inbox creation and email sending (Node.js) |
| `mailQueries.ts` | Internal queries and mutations for email data management |
| `http.ts` | HTTP endpoint for AgentMail webhook to receive inbound emails |

### Generated Files (convex/)

| Directory | Description |
|-----------|-------------|
| `_generated/` | Auto-generated TypeScript types and API from Convex schema |

## Frontend Source (`src/`)

### Entry Point

| File | Description |
|------|-------------|
| `main.tsx` | React application entry point with Convex provider |
| `App.tsx` | Root component with React Router and layout |
| `App.css` | Styles for app container, header, footer, and navigation |

### Styles

| File | Description |
|------|-------------|
| `index.css` | Global styles and CSS variables for tan theme |

### Components (`src/components/`)

#### Chat Components

| File | Description |
|------|-------------|
| `Chat.tsx` | Main chat interface with message display and email panel toggle |
| `Chat.css` | Styles for chat container, messages, and layout |
| `Composer.tsx` | Message input component with send functionality |
| `Composer.css` | Styles for message composer input and button |
| `EmailPanel.tsx` | Email functionality UI for inbox creation and sending |
| `EmailPanel.css` | Styles for email panel, forms, and inbox display |

#### Documentation Components

| File | Description |
|------|-------------|
| `Docs.tsx` | Comprehensive documentation page with setup and feature guides |
| `Docs.css` | Styles for documentation layout, sidebar, and content |
| `Changelog.tsx` | Version history and release notes page |
| `Changelog.css` | Styles for changelog timeline and version blocks |

## Build Output (`dist/`)

Generated by Vite build process, contains production-ready static files.

## Key Features by File

### Real-time Chat
- `convex/messages.ts` - Message queries with realtime subscriptions
- `src/components/Chat.tsx` - Chat UI with live updates
- `src/components/Composer.tsx` - Message input

### AI Agent
- `convex/agent.ts` - OpenAI API integration
- `convex/agentQueries.ts` - Context loading and response storage

### Email Integration
- `convex/mail.ts` - AgentMail API for inbox and sending
- `convex/mailQueries.ts` - Email data management
- `convex/http.ts` - Webhook for receiving emails
- `src/components/EmailPanel.tsx` - Email UI

### Routing & Navigation
- `src/App.tsx` - React Router configuration
- `netlify.toml` - SPA routing support for deployment

### Type Safety
- All `convex/*.ts` files - Validators for args and returns
- `tsconfig.json` - Strict TypeScript configuration
- `convex/_generated/` - Auto-generated types from schema

## File Count Summary

- **Convex Backend**: 7 files
- **React Components**: 6 files + 6 CSS files
- **Configuration**: 6 files
- **Documentation**: 5 files

Total project files: ~30 source files (excluding node_modules and generated files)

## What Works

### Core Features (Production Ready)
- **Realtime Chat** - Messages sync instantly via Convex subscriptions
- **AI Agent** - GPT-4o-mini powered responses with conversation context (via OpenAI)
- **Email Integration** - AgentMail inbox creation, sending, and receiving via webhook
- **Chat Export** - Send conversation transcripts to any email address
- **Production Deployment** - Successfully deploys to Netlify with Convex Cloud backend

### Technology Stack
- **Convex** - Realtime backend with subscriptions, scheduled functions, HTTP endpoints, and database with indexes
- **OpenAI** - AI responses via GPT-4o-mini with conversation context
- **AgentMail** - Email infrastructure for agents with programmatic inbox creation
- **React 19** - Modern UI with TypeScript and hooks
- **Vite** - Fast build tool and dev server
- **Netlify** - Production hosting with automatic deployments

### Recent Fixes (v1.1.1)
- **TypeScript Build Errors** - Added missing @types/node dependency
  - Fixed 4 TypeScript errors in `convex/agent.ts` and `convex/mail.ts`
  - Resolved `process.env` type issues in Convex actions
  - Production builds now complete successfully on Netlify
  - All Node.js actions properly typed for production

### How It Works
1. **Chat Flow** - User sends message → saved to Convex → AI agent scheduled → OpenAI generates response → saved → UI updates in realtime
2. **Email Send Flow** - Create inbox → user sends email via AgentMail → recorded in messages → UI updates
3. **Email Receive Flow** - Email arrives → AgentMail webhook → HTTP action → saved to messages → UI updates
4. **Export Flow** - User clicks export → enters email → transcript formatted → sent via AgentMail → success message

